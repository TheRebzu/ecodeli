// Mod√®les authentification

model Session {
  id                String              @id @default(cuid())
  userId            String
  token             String              @unique
  userAgent         String?
  ip                String?
  expiresAt         DateTime
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  
  user              User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([token])
  @@index([userId])
  @@index([expiresAt])
}

model PasswordReset {
  id                String              @id @default(cuid())
  email             String
  token             String              @unique
  expiresAt         DateTime
  used              Boolean             @default(false)
  createdAt         DateTime            @default(now())
  
  @@index([token])
  @@index([email])
  @@index([expiresAt])
}

model Account {
  id                String              @id @default(cuid())
  userId            String
  type              String
  provider          String
  providerAccountId String
  refresh_token     String?             @db.Text
  access_token      String?             @db.Text
  expires_at        Int?
  token_type        String?
  scope             String?
  id_token          String?             @db.Text
  session_state     String?
  createdAt         DateTime            @default(now())
  updatedAt         DateTime            @updatedAt
  
  user              User                @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@unique([provider, providerAccountId])
  @@index([userId])
}

model VerificationToken {
  id                String              @id @default(cuid())
  identifier        String              // email ou autre identifiant
  token             String              @unique
  expires           DateTime
  type              String              // 'email_verification', 'password_reset', etc.
  createdAt         DateTime            @default(now())
  
  @@index([token])
  @@index([identifier])
  @@index([expires])
  @@index([type])
}
